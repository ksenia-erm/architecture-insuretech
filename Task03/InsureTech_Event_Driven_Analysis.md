# Проблемы и риски, связанные с планируемым ростом нагрузки
1. Синхронная связность через REST:
- `core-app` и `ins-comp-settlement` зависят от ответов `ins-product-aggregator` в момент запроса
- задержка или ошибка на стороне `ins-product-aggregator` или страховых компаний приводит к деградации фронта и ночных задач
2. Синхронный запрос к внешним страховым компаниям в онлайне:
- `ins-product-aggregator` при каждом запросе ходит в 5 внешних API
- с ростом числа компаний растёт время ответа и вероятность таймаутов и каскадных ошибок (одна медленная компания блокирует весь ответ)
3. Локальные реплики тарифов с периодическим обновлением:
- core-app обновляет данные раз в 15 минут, ins-comp-settlement — раз в сутки
- данные в сервисах легко расходятся с актуальными тарифами, особенно при частых изменениях продуктов
4. Ночные batch‑запросы `ins-comp-settlement` → `core-app`:
- один большой REST‑запрос на получение всех оформленных за день страховок создаёт пик нагрузки ночью
- при ошибке/таймауте надо перезапускать весь обмен, возможны дубликаты и пропуски
5. Отсутствие явного механизма повторов и гарантированной доставки:
- взаимодействия по REST без устойчивых ретраев и DLQ механизма приводит к потере данных при кратковременных сбоях
- нет чёткой трассировки событий «продукт обновлён», «страховка оформлена»
6. Планируемое удвоение числа страховых компаний:
- время ответа `ins-product-aggregator` будет расти линейно с количеством интеграций
- SLA и для web-клиентов, и для B2B ещё сильнее пострадает при пиках
7. Риск гонки данных при переходе на события:
- если просто начать писать и в свою БД, и в брокер (Kafka/Rabbit), появляется риск несогласованности данных при падении между операциями
- для надёжных событий нужен паттерн Transactional Outbox